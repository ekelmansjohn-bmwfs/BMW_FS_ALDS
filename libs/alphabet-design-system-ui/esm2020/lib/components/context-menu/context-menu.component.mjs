import { __decorate, __metadata } from "tslib";
/* eslint-disable functional/immutable-data */
import { DOCUMENT } from '@angular/common';
import { ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, Inject, Input, ViewChild, } from '@angular/core';
import { WINDOW } from '@ng-web-apis/common';
import { UntilDestroy, untilDestroyed } from '@ngneat/until-destroy';
import { fromEvent } from 'rxjs';
import { filter } from 'rxjs/operators';
import { CollisionDetectionService, randomId } from '../../utils';
import * as i0 from "@angular/core";
import * as i1 from "../../utils";
import * as i2 from "@angular/common";
let ADSContextMenuComponent = class ADSContextMenuComponent {
    constructor(windowRef, document, cdr, collisionDetection) {
        this.windowRef = windowRef;
        this.document = document;
        this.cdr = cdr;
        this.collisionDetection = collisionDetection;
        this.size = 'regular';
        this.id = `ads-context-menu-${randomId()}`;
        this.selectedMenuItem = 0;
        this.visible = false;
    }
    toggle() {
        this.visible = !this.visible;
        this.buttonElement.setAttribute('aria-expanded', this.visible.toString());
        this.cdr.detectChanges();
        if (this.visible) {
            this.collisionDetection.detect(this.contextMenu.nativeElement, this.menuElement);
        }
    }
    first() {
        this.selectedMenuItem = 0;
        this.selectMenuItem();
    }
    last() {
        this.selectedMenuItem = this.menuElementItems.length - 1;
        this.selectMenuItem();
    }
    next() {
        this.selectedMenuItem =
            this.selectedMenuItem + 1 > this.menuElementItems.length - 1
                ? 0
                : this.selectedMenuItem + 1;
        this.selectMenuItem();
    }
    previous() {
        this.selectedMenuItem =
            this.selectedMenuItem - 1 < 0
                ? this.menuElementItems.length - 1
                : this.selectedMenuItem - 1;
        this.selectMenuItem();
    }
    selectMenuItem() {
        const button = this.menuElementItems[this.selectedMenuItem].querySelector('.ads-button');
        const checkbox = this.menuElementItems[this.selectedMenuItem].querySelector('.ads-form-checkbox');
        button?.focus();
        checkbox?.focus();
    }
    ngAfterViewInit() {
        this.buttonElement = this.contextMenu.nativeElement.querySelector('.ads-button');
        this.menuElement = this.contextMenu.nativeElement.querySelector('ul');
        this.menuElementItems = Array.from(this.menuElement.querySelectorAll('li')).filter((item) => item.querySelector('.ads-button') ?? item.querySelector('.ads-form-checkbox'));
        if (this.buttonElement) {
            this.buttonElement.setAttribute('aria-controls', this.id);
            this.buttonElement.setAttribute('aria-expanded', 'false');
            this.buttonElement.setAttribute('aria-haspopup', 'true');
            this.menuElement.setAttribute('id', this.id);
            this.menuElement.setAttribute('role', 'list');
            this.menuElement.setAttribute('tabindex', '-1');
            fromEvent(this.buttonElement, 'click')
                .pipe(untilDestroyed(this))
                .subscribe(() => {
                this.toggle();
                if (this.visible) {
                    this.first();
                }
                else {
                    this.buttonElement.focus();
                }
            });
            fromEvent(this.buttonElement, 'keydown')
                .pipe(untilDestroyed(this))
                .subscribe((event) => {
                if (event.key === "Spacebar" /* ADSKeyEvents.KEY_SPACEBAR */ ||
                    event.key === "ArrowDown" /* ADSKeyEvents.KEY_ARROW_DOWN */ ||
                    event.key === "Enter" /* ADSKeyEvents.KEY_ENTER */) {
                    event.preventDefault();
                    this.toggle();
                    this.first();
                }
                if (event.key === "ArrowUp" /* ADSKeyEvents.KEY_ARROW_UP */) {
                    event.preventDefault();
                    this.toggle();
                    this.last();
                }
                if (event.key === "Escape" /* ADSKeyEvents.KEY_ESCAPE */) {
                    if (this.visible) {
                        this.toggle();
                        this.buttonElement.focus();
                    }
                }
            });
            fromEvent(this.menuElement, 'keydown')
                .pipe(untilDestroyed(this), filter(() => this.visible))
                .subscribe((event) => {
                if (event.key === "Tab" /* ADSKeyEvents.KEY_TAB */) {
                    this.toggle();
                }
                if (event.key === "ArrowDown" /* ADSKeyEvents.KEY_ARROW_DOWN */) {
                    event.preventDefault();
                    this.next();
                }
                if (event.key === "ArrowUp" /* ADSKeyEvents.KEY_ARROW_UP */) {
                    event.preventDefault();
                    this.previous();
                }
                if (event.key === "Home" /* ADSKeyEvents.KEY_HOME */) {
                    event.preventDefault();
                    this.first();
                }
                if (event.key === "End" /* ADSKeyEvents.KEY_END */) {
                    event.preventDefault();
                    this.last();
                }
                if (event.key === "Escape" /* ADSKeyEvents.KEY_ESCAPE */) {
                    this.toggle();
                    this.buttonElement?.focus();
                }
            });
            fromEvent(this.menuElement, 'click')
                .pipe(untilDestroyed(this), filter(() => this.visible))
                .subscribe((event) => {
                const target = event.target;
                const li = target?.closest('li');
                // only close if its a button
                if (li?.firstChild?.nodeName === 'ADS-BUTTON') {
                    this.toggle();
                    this.buttonElement.focus();
                }
            });
            fromEvent(this.document, 'click')
                .pipe(untilDestroyed(this), filter(() => this.visible))
                .subscribe((event) => {
                const target = event.target;
                const parent = target.closest('.ads-context-menu');
                if (!parent || parent.id !== this.id) {
                    this.toggle();
                }
            });
            fromEvent(this.windowRef, 'resize')
                .pipe(untilDestroyed(this), filter(() => this.visible))
                .subscribe(() => this.collisionDetection.detect(this.contextMenu.nativeElement, this.menuElement));
        }
    }
};
ADSContextMenuComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.6", ngImport: i0, type: ADSContextMenuComponent, deps: [{ token: WINDOW }, { token: DOCUMENT }, { token: i0.ChangeDetectorRef }, { token: i1.CollisionDetectionService }], target: i0.ɵɵFactoryTarget.Component });
ADSContextMenuComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.6", type: ADSContextMenuComponent, selector: "ads-context-menu", inputs: { css: "css", size: "size" }, viewQueries: [{ propertyName: "contextMenu", first: true, predicate: ["contextMenu"], descendants: true }], ngImport: i0, template: "<!-- Context menu -->\r\n<div\r\n    #contextMenu\r\n    id=\"{{ id }}\"\r\n    class=\"ads-context-menu size-{{ size }} {{ css }}\"\r\n    [ngClass]=\"{ 'is-expanded': visible }\"\r\n>\r\n    <ng-content></ng-content>\r\n</div>\r\n", styles: [":root{--ads-color-white: #fff;--ads-color-white_foreground: #000;--ads-color-gray-6: #f0f0f0;--ads-color-gray-6_foreground: #000;--ads-color-gray-12: #e0e0e0;--ads-color-gray-12_foreground: #000;--ads-color-gray-20: #cccccc;--ads-color-gray-20_foreground: #000;--ads-color-gray-50: gray;--ads-color-gray-50_foreground: #fff;--ads-color-gray-70: #4d4d4d;--ads-color-gray-70_foreground: #fff;--ads-color-gray-85: #262626;--ads-color-gray-85_foreground: #fff;--ads-color-black: #000;--ads-color-black_foreground: #fff;--ads-color-error: #d21e36;--ads-color-error_hover: #a5182b;--ads-color-error-background: #fceaea;--ads-color-info: #1e236e;--ads-color-info-background: var(--ads-color-gray-6);--ads-color-success: #01964c;--ads-color-success_hover: #016332;--ads-color-success-background: #eaf6eb;--ads-color-warning: #ef7d00;--ads-color-warning-background: #fff7ef;--ads-color-notification: #ffd900;--ads-color-notification-background: #fffdf0;--ads-color-primary: #1e236e;--ads-color-primary-40: #a5a7c5;--ads-color-primary-65: #6e71a2;--ads-color-primary-foreground: #fff;--ads-color-primary_active: #0a0c26;--ads-color-primary_active-foreground: #fff;--ads-color-primary_focus: #0f1136;--ads-color-primary_focus-foreground: #fff;--ads-color-primary_hover: #131646;--ads-color-primary_hover-foreground: #fff;--ads-color-secondary: #00d7e7;--ads-color-secondary-40: #9aeff5;--ads-color-secondary-65: #5ae5ef;--ads-color-secondary-foreground: #fff;--ads-color-secondary_active: #00828b;--ads-color-secondary_active-foreground: #fff;--ads-color-secondary_focus: #0095a0;--ads-color-secondary_focus-foreground: #fff;--ads-color-secondary_hover: #00a8b4;--ads-color-secondary_hover-foreground: #fff;--ads-color-accent: #ff6d6a;--ads-color-accent-40: #ffc5c3;--ads-color-accent-65: #ffa19f;--ads-color-accent-foreground: #fff;--ads-color-accent_active: #ff5451;--ads-color-accent_active-foreground: #fff;--ads-color-accent_hover: #ff3b37;--ads-color-accent_hover-foreground: #fff;--ads-color-accent_focus: #ff221e;--ads-color-accent_focus-foreground: #fff;--ads-color-disabled: #e0e0e0;--ads-color-disabled-foreground: gray;--ads-color-app: #fff;--ads-color-app-text: #262626;--ads-color-app-navigation: #1e236e;--ads-color-app-navigation-divider: #6e71a2;--ads-color-app-navigation-menu-item-foreground: #fff;--ads-color-app-navigation-menu-item-background: #1e236e;--ads-color-app-navigation-menu-item-foreground_hover: #00d7e7;--ads-color-app-navigation-menu-item-background_hover: #1e236e;--ads-color-app-navigation-menu-item-foreground_focus: #fff;--ads-color-app-navigation-menu-item-background_focus: #fff;--ads-color-app-navigation-menu-item-foreground_selected: #00d7e7;--ads-color-app-navigation-menu-item-background_selected: #1e236e;--ads-color-app-navigation-menu-item-icon-foreground: #fff;--ads-color-app-navigation-menu-item-icon-background: #1e236e;--ads-color-app-navigation-menu-item-icon-foreground_hover: #00d7e7;--ads-color-app-navigation-menu-item-icon-background_hover: #1e236e;--ads-color-app-navigation-menu-item-icon-foreground_focus: #1e236e;--ads-color-app-navigation-menu-item-icon-background_focus: #fff;--ads-color-app-navigation-menu-item-icon-foreground_selected: #00d7e7;--ads-color-app-navigation-menu-item-icon-background_selected: #1e236e;--ads-color-app-navigation-toolbar: #fff;--ads-color-app-navigation-toolbar-divider: #e0e0e0;--ads-color-app-navigation-toolbar-menu-item-foreground: #1e236e;--ads-color-app-navigation-toolbar-menu-item-background: #fff;--ads-color-app-navigation-toolbar-menu-item-foreground_hover: #1e236e;--ads-color-app-navigation-toolbar-menu-item-background_hover: #f0f0f0;--ads-color-app-navigation-toolbar-menu-item-foreground_focus: #1e236e;--ads-color-app-navigation-toolbar-menu-item-background_focus: #fff;--ads-color-app-navigation-toolbar-menu-item-foreground_selected: #1e236e;--ads-color-app-navigation-toolbar-menu-item-background_selected: #e0e0e0;--ads-color-app-navigation-toolbar-menu-item-icon-foreground: #1e236e;--ads-color-app-navigation-toolbar-menu-item-icon-background: #fff;--ads-color-app-navigation-toolbar-menu-item-icon-foreground_hover: #1e236e;--ads-color-app-navigation-toolbar-menu-item-icon-background_hover: #f0f0f0;--ads-color-app-navigation-toolbar-menu-item-icon-foreground_focus: #1e236e;--ads-color-app-navigation-toolbar-menu-item-icon-background_focus: #fff;--ads-color-app-navigation-toolbar-menu-item-icon-foreground_selected: #1e236e;--ads-color-app-navigation-toolbar-menu-item-icon-background_selected: #f0f0f0;--ads-color-solid-gradient-primary-to-accent: linear-gradient(90deg, #1e236e 0%, #ff6d6a 100%);--ads-color-solid-gradient-secondary-to-accent: linear-gradient(-170deg, rgba(0, 215, 231, 0) 60%, #00d7e7 125%), linear-gradient(170deg, #ff6d6a 60%, #ff6d6a 125%);--ads-color-solid-gradient-accent-to-secondary-to-primary: linear-gradient(90deg, #ff6d6a 0%, #00d7e7 50%, #1e236e 100%);--ads-color-solid-gradient-gray-to-primary: linear-gradient(90deg, #e0e0e0 0%, #a5a7c5 100%);--ads-color-image-gradient-primary-to-accent: linear-gradient(90deg, rgba(30, 35, 110, .7) 0, rgba(255, 109, 106, .7) 100%);--ads-color-image-gradient-accent-to-primary: linear-gradient(90deg, rgba(255, 109, 106, .7) 0, rgba(30, 35, 110, .7) 100%);--ads-color-image-gradient-secondary-to-accent: linear-gradient(90deg, rgba(0, 215, 231, .7) 0, rgba(255, 109, 106, .7) 100%);--ads-color-image-gradient-accent-to-secondary: linear-gradient(90deg, rgba(255, 109, 106, .7) 0, rgba(0, 215, 231, .7) 100%);--ads-color-image-gradient-mask: linear-gradient(to bottom, rgba(0,0,0,0) 48%, rgba(0,0,0,.5) 80%, rgba(0,0,0,1) 100%);--ads-color-image-gradient-darken-bottom: linear-gradient(rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, .1) 40%, rgba(0, 0, 0, .4) 100%);--ads-color-app-gradient-secondary-to-accent: linear-gradient(160deg, rgba(255, 109, 106, .05) 0%, rgba(255, 109, 106, 0) 55%, rgba(255, 109, 106, .4) 90%), linear-gradient(220deg, rgba(0, 215, 231, .05) 0%, rgba(0, 215, 231, 0) 60%, rgba(0, 215, 231, .6) 90%), linear-gradient(var(--ads-color-primary), var(--ads-color-primary));--ads-color-app-gradient-secondary-to-accent-large: linear-gradient(170deg, rgba(255, 109, 106, .05) 0%, rgba(255, 109, 106, 0) 65%, rgba(255, 109, 106, .5) 90%), linear-gradient(210deg, rgba(0, 215, 231, .05) 0%, rgba(0, 215, 231, 0) 70%, rgba(0, 215, 231, .6) 90%), linear-gradient(var(--ads-color-primary), var(--ads-color-primary));--ads-color-app-gradient-secondary-to-accent-foreground: #fff;--ads-color-app-gradient-primary-to-accent: linear-gradient(200deg, rgba(255, 109, 106, .05) 0%, rgba(255, 109, 106, 0) 55%, rgba(255, 109, 106, .7) 90%), linear-gradient(160deg, rgba(30, 35, 110, .05) 0%, rgba(30, 35, 110, 0) 60%, rgba(30, 35, 110, .4) 90%), linear-gradient(var(--ads-color-secondary), var(--ads-color-secondary-40));--ads-color-app-gradient-primary-to-accent-large: linear-gradient(190deg, rgba(255, 109, 106, .05) 0%, rgba(255, 109, 106, 0) 65%, rgba(255, 109, 106, .6) 90%), linear-gradient(160deg, rgba(30, 35, 110, .05) 0%, rgba(30, 35, 110, 0) 70%, rgba(30, 35, 110, .5) 90%), linear-gradient(var(--ads-color-secondary), var(--ads-color-secondary-40));--ads-color-app-gradient-primary-to-accent-foreground: #1e236e;--ads-color-app-gradient-primary-inverted: linear-gradient(200deg, rgba(255, 109, 106, 0) 0%, rgba(255, 109, 106, 0) 60%, rgba(255, 109, 106, .4) 90%), linear-gradient(160deg, rgba(0, 215, 231, 0) 0%, rgba(0, 215, 231, 0) 65%, rgba(0, 215, 231, .45) 90%), linear-gradient(var(--ads-color-white), var(--ads-color-white));--ads-color-app-gradient-primary-inverted-large: linear-gradient(200deg, rgba(255, 109, 106, 0) 0%, rgba(255, 109, 106, 0) 75%, rgba(255, 109, 106, .05) 90%), linear-gradient(160deg, rgba(0, 215, 231, 0) 0%, rgba(0, 215, 231, 0) 75%, rgba(0, 215, 231, .02) 90%), linear-gradient(var(--ads-color-white), var(--ads-color-white));--ads-color-app-gradient-primary-inverted-foreground: #1e236e;--ads-ring_active: 0 0 0 2px #fff, 0 0 0 5px #1e236e;--ads-ring_focus: 0 0 0 2px #fff, 0 0 0 4px #1e236e;--ads-ring_hover: 0 0 0 2px #fff, 0 0 0 4px #1e236e;--ads-ring_transparent: 0 0 0 2px transparent, 0 0 0 3px transparent;--ads-ring_focus-inset: inset 0 0 0 2px #fff, inset 0 0 0 3px #1e236e;--ads-ring_focus-inset-inverted: inset 0 0 0 2px #1e236e, inset 0 0 0 4px #fff;--ads-ring-focus-with-contextmenu: 0 0 0 1px #fff, 0 0 0 2px #555cd1, 0 .7px .7px rgba(0, 0, 0, .05), 0 1.7px 1.7px rgba(0, 0, 0, .036), 0 3.1px 3.1px rgba(0, 0, 0, .03), 0 5.6px 5.6px rgba(0, 0, 0, .025), 0 10.4px 10.4px rgba(0, 0, 0, .02), 0 25px 25px rgba(0, 0, 0, .014);--ads-shadow-depth-0: 0 0 0 0 rgba(0, 0, 0, 0);--ads-shadow-depth-1: 0 .4px .4px rgba(0, 0, 0, .05), 0 1px 1px rgba(0, 0, 0, .036), 0 1.9px 1.9px rgba(0, 0, 0, .03), 0 3.4px 3.4px rgba(0, 0, 0, .025), 0 6.3px 6.3px rgba(0, 0, 0, .02), 0 15px 15px rgba(0, 0, 0, .014);--ads-shadow-depth-2: 0 .7px .7px rgba(0, 0, 0, .05), 0 1.7px 1.7px rgba(0, 0, 0, .036), 0 3.1px 3.1px rgba(0, 0, 0, .03), 0 5.6px 5.6px rgba(0, 0, 0, .025), 0 10.4px 10.4px rgba(0, 0, 0, .02), 0 25px 25px rgba(0, 0, 0, .014);--ads-shadow-depth-3: 0 .7px .7px rgba(0, 0, 0, .017), 0 1.7px 1.7px rgba(0, 0, 0, .024), 0 3.1px 3.1px rgba(0, 0, 0, .03), 0 5.6px 5.6px rgba(0, 0, 0, .036), 0 10.4px 10.4px rgba(0, 0, 0, .043), 0 25px 25px rgba(0, 0, 0, .06);--ads-shadow-depth-4: 0 1px 1px rgba(0, 0, 0, .014), 0 2.3px 2.3px rgba(0, 0, 0, .02), 0 4.4px 4.4px rgba(0, 0, 0, .025), 0 7.8px 7.8px rgba(0, 0, 0, .03), 0 14.6px 14.6px rgba(0, 0, 0, .036), 0 35px 35px rgba(0, 0, 0, .05);--ads-shadow-depth-5: 0 1.2px 1.2px rgba(0, 0, 0, .014), 0 3px 3px rgba(0, 0, 0, .02), 0 5.6px 5.6px rgba(0, 0, 0, .025), 0 10.1px 10.1px rgba(0, 0, 0, .03), 0 18.8px 18.8px rgba(0, 0, 0, .036), 0 45px 45px rgba(0, 0, 0, .05);--ads-shadow-depth-6: 0 .9px .9px rgba(0, 0, 0, .011), 0 1.9px 1.9px rgba(0, 0, 0, .016), 0 3.2px 3.2px rgba(0, 0, 0, .019), 0 4.8px 4.8px rgba(0, 0, 0, .022), 0 6.9px 6.9px rgba(0, 0, 0, .025), 0 9.7px 9.7px rgba(0, 0, 0, .028), 0 13.8px 13.8px rgba(0, 0, 0, .031), 0 20.1px 20.1px rgba(0, 0, 0, .034), 0 30.9px 30.9px rgba(0, 0, 0, .039), 0 55px 55px rgba(0, 0, 0, .05)}.ads-context-menu{position:relative;z-index:auto;display:inline-block;padding:0}.ads-context-menu ::ng-deep button.ads-custom-button{position:relative;display:inline-block;width:auto;align-items:center;padding:0;border:none;margin:0;-webkit-appearance:none;appearance:none;background-color:transparent;border-radius:.25rem;cursor:pointer;font-family:Alphabet sans pro,sans-serif;font-size:1rem;font-style:normal;font-weight:400;line-height:1;outline:0;outline-offset:0;transition:color .15s cubic-bezier(.55,.085,.68,.53),background-color .15s cubic-bezier(.55,.085,.68,.53);white-space:nowrap}.ads-context-menu ::ng-deep button.ads-custom-button:focus:not(:disabled){box-shadow:var(--ads-ring_focus)}.ads-context-menu ::ng-deep ul{position:absolute;top:3rem;right:auto;bottom:auto;left:0;display:none;width:16rem;max-width:calc(100vw - 4rem);max-height:25rem;padding:.5rem 0;border:1px solid var(--ads-color-gray-20);background-color:var(--ads-color-app);border-radius:.25rem;box-shadow:var(--ads-shadow-depth-3);list-style:none;overflow-x:hidden;overflow-y:auto}.ads-context-menu ::ng-deep ul li.context-menu_header{display:flex;align-items:center;padding:.5rem 1rem;color:var(--ads-color-primary);font-family:Alphabet sans pro,sans-serif;font-size:1rem;font-style:normal;font-weight:600}.ads-context-menu ::ng-deep ul li.context-menu_header span{flex:1 1 0%}.ads-context-menu ::ng-deep ul li.context-menu_header al-form-checkbox{flex:none}.ads-context-menu ::ng-deep ul li.context-menu_header al-form-checkbox .ads-form-checkbox.is-checkbox+label{margin-right:0;margin-bottom:0}.ads-context-menu ::ng-deep ul li.context-menu_header-title{display:flex;flex-direction:column;align-items:flex-start;padding:.5rem 1rem}.ads-context-menu ::ng-deep ul li.context-menu_header-title span{flex:1 1 0%}.ads-context-menu ::ng-deep ul li ads-button:not(.regular) .ads-button{width:100%;padding:1rem .625rem;border-radius:0;text-align:left}.ads-context-menu ::ng-deep ul li ads-button:not(.regular) .ads-button span{display:inline-block;max-width:80%;text-overflow:ellipsis;white-space:nowrap}.ads-context-menu ::ng-deep ul li ads-button:not(.regular) .ads-button.is-button-ghost:hover{background-color:var(--ads-color-gray-20);box-shadow:var(--ads-ring_transparent);color:var(--ads-color-gray-20_foreground)}.ads-context-menu ::ng-deep ul li ads-button:not(.regular) .ads-button.is-button-ghost:focus{background-color:var(--ads-color-secondary);box-shadow:var(--ads-ring_transparent);color:var(--ads-color-white)}.ads-context-menu ::ng-deep ul li ads-button:not(.regular) .ads-button.is-button-ghost:focus ::ng-deep .ads-icon svg path{fill:var(--ads-color-white)}.ads-context-menu ::ng-deep ul li al-form-checkbox{display:block}.ads-context-menu ::ng-deep ul li al-form-checkbox .ads-form-checkbox.is-switch+label{margin-bottom:0;font-size:.875rem}.ads-context-menu ::ng-deep ul li hr{border:none;border-top:1px solid var(--ads-color-gray-20);margin:0}.ads-context-menu.is-expanded ::ng-deep .ads-button[aria-haspopup=true]{box-shadow:var(--ads-ring_focus-with-contextmenu)}.ads-context-menu.is-expanded ::ng-deep ul{z-index:10;display:block}.ads-context-menu.place-floating-element-left ::ng-deep ul{right:0;left:auto}.ads-context-menu.place-floating-element-right ::ng-deep ul{right:auto;left:0}.ads-context-menu.place-floating-element-at-top ::ng-deep ul{top:auto;bottom:3rem}.ads-context-menu.place-floating-element-at-top.size-small ::ng-deep ul{top:auto;bottom:2.5rem}.ads-context-menu.place-floating-element-at-bottom ::ng-deep ul{top:3rem;bottom:auto}.ads-context-menu.place-floating-element-at-bottom.size-small ::ng-deep ul{top:2.5rem;bottom:auto}\n"], dependencies: [{ kind: "directive", type: i2.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
ADSContextMenuComponent = __decorate([
    UntilDestroy(),
    __metadata("design:paramtypes", [Window,
        Document,
        ChangeDetectorRef,
        CollisionDetectionService])
], ADSContextMenuComponent);
export { ADSContextMenuComponent };
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.6", ngImport: i0, type: ADSContextMenuComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ads-context-menu', changeDetection: ChangeDetectionStrategy.OnPush, template: "<!-- Context menu -->\r\n<div\r\n    #contextMenu\r\n    id=\"{{ id }}\"\r\n    class=\"ads-context-menu size-{{ size }} {{ css }}\"\r\n    [ngClass]=\"{ 'is-expanded': visible }\"\r\n>\r\n    <ng-content></ng-content>\r\n</div>\r\n", styles: [":root{--ads-color-white: #fff;--ads-color-white_foreground: #000;--ads-color-gray-6: #f0f0f0;--ads-color-gray-6_foreground: #000;--ads-color-gray-12: #e0e0e0;--ads-color-gray-12_foreground: #000;--ads-color-gray-20: #cccccc;--ads-color-gray-20_foreground: #000;--ads-color-gray-50: gray;--ads-color-gray-50_foreground: #fff;--ads-color-gray-70: #4d4d4d;--ads-color-gray-70_foreground: #fff;--ads-color-gray-85: #262626;--ads-color-gray-85_foreground: #fff;--ads-color-black: #000;--ads-color-black_foreground: #fff;--ads-color-error: #d21e36;--ads-color-error_hover: #a5182b;--ads-color-error-background: #fceaea;--ads-color-info: #1e236e;--ads-color-info-background: var(--ads-color-gray-6);--ads-color-success: #01964c;--ads-color-success_hover: #016332;--ads-color-success-background: #eaf6eb;--ads-color-warning: #ef7d00;--ads-color-warning-background: #fff7ef;--ads-color-notification: #ffd900;--ads-color-notification-background: #fffdf0;--ads-color-primary: #1e236e;--ads-color-primary-40: #a5a7c5;--ads-color-primary-65: #6e71a2;--ads-color-primary-foreground: #fff;--ads-color-primary_active: #0a0c26;--ads-color-primary_active-foreground: #fff;--ads-color-primary_focus: #0f1136;--ads-color-primary_focus-foreground: #fff;--ads-color-primary_hover: #131646;--ads-color-primary_hover-foreground: #fff;--ads-color-secondary: #00d7e7;--ads-color-secondary-40: #9aeff5;--ads-color-secondary-65: #5ae5ef;--ads-color-secondary-foreground: #fff;--ads-color-secondary_active: #00828b;--ads-color-secondary_active-foreground: #fff;--ads-color-secondary_focus: #0095a0;--ads-color-secondary_focus-foreground: #fff;--ads-color-secondary_hover: #00a8b4;--ads-color-secondary_hover-foreground: #fff;--ads-color-accent: #ff6d6a;--ads-color-accent-40: #ffc5c3;--ads-color-accent-65: #ffa19f;--ads-color-accent-foreground: #fff;--ads-color-accent_active: #ff5451;--ads-color-accent_active-foreground: #fff;--ads-color-accent_hover: #ff3b37;--ads-color-accent_hover-foreground: #fff;--ads-color-accent_focus: #ff221e;--ads-color-accent_focus-foreground: #fff;--ads-color-disabled: #e0e0e0;--ads-color-disabled-foreground: gray;--ads-color-app: #fff;--ads-color-app-text: #262626;--ads-color-app-navigation: #1e236e;--ads-color-app-navigation-divider: #6e71a2;--ads-color-app-navigation-menu-item-foreground: #fff;--ads-color-app-navigation-menu-item-background: #1e236e;--ads-color-app-navigation-menu-item-foreground_hover: #00d7e7;--ads-color-app-navigation-menu-item-background_hover: #1e236e;--ads-color-app-navigation-menu-item-foreground_focus: #fff;--ads-color-app-navigation-menu-item-background_focus: #fff;--ads-color-app-navigation-menu-item-foreground_selected: #00d7e7;--ads-color-app-navigation-menu-item-background_selected: #1e236e;--ads-color-app-navigation-menu-item-icon-foreground: #fff;--ads-color-app-navigation-menu-item-icon-background: #1e236e;--ads-color-app-navigation-menu-item-icon-foreground_hover: #00d7e7;--ads-color-app-navigation-menu-item-icon-background_hover: #1e236e;--ads-color-app-navigation-menu-item-icon-foreground_focus: #1e236e;--ads-color-app-navigation-menu-item-icon-background_focus: #fff;--ads-color-app-navigation-menu-item-icon-foreground_selected: #00d7e7;--ads-color-app-navigation-menu-item-icon-background_selected: #1e236e;--ads-color-app-navigation-toolbar: #fff;--ads-color-app-navigation-toolbar-divider: #e0e0e0;--ads-color-app-navigation-toolbar-menu-item-foreground: #1e236e;--ads-color-app-navigation-toolbar-menu-item-background: #fff;--ads-color-app-navigation-toolbar-menu-item-foreground_hover: #1e236e;--ads-color-app-navigation-toolbar-menu-item-background_hover: #f0f0f0;--ads-color-app-navigation-toolbar-menu-item-foreground_focus: #1e236e;--ads-color-app-navigation-toolbar-menu-item-background_focus: #fff;--ads-color-app-navigation-toolbar-menu-item-foreground_selected: #1e236e;--ads-color-app-navigation-toolbar-menu-item-background_selected: #e0e0e0;--ads-color-app-navigation-toolbar-menu-item-icon-foreground: #1e236e;--ads-color-app-navigation-toolbar-menu-item-icon-background: #fff;--ads-color-app-navigation-toolbar-menu-item-icon-foreground_hover: #1e236e;--ads-color-app-navigation-toolbar-menu-item-icon-background_hover: #f0f0f0;--ads-color-app-navigation-toolbar-menu-item-icon-foreground_focus: #1e236e;--ads-color-app-navigation-toolbar-menu-item-icon-background_focus: #fff;--ads-color-app-navigation-toolbar-menu-item-icon-foreground_selected: #1e236e;--ads-color-app-navigation-toolbar-menu-item-icon-background_selected: #f0f0f0;--ads-color-solid-gradient-primary-to-accent: linear-gradient(90deg, #1e236e 0%, #ff6d6a 100%);--ads-color-solid-gradient-secondary-to-accent: linear-gradient(-170deg, rgba(0, 215, 231, 0) 60%, #00d7e7 125%), linear-gradient(170deg, #ff6d6a 60%, #ff6d6a 125%);--ads-color-solid-gradient-accent-to-secondary-to-primary: linear-gradient(90deg, #ff6d6a 0%, #00d7e7 50%, #1e236e 100%);--ads-color-solid-gradient-gray-to-primary: linear-gradient(90deg, #e0e0e0 0%, #a5a7c5 100%);--ads-color-image-gradient-primary-to-accent: linear-gradient(90deg, rgba(30, 35, 110, .7) 0, rgba(255, 109, 106, .7) 100%);--ads-color-image-gradient-accent-to-primary: linear-gradient(90deg, rgba(255, 109, 106, .7) 0, rgba(30, 35, 110, .7) 100%);--ads-color-image-gradient-secondary-to-accent: linear-gradient(90deg, rgba(0, 215, 231, .7) 0, rgba(255, 109, 106, .7) 100%);--ads-color-image-gradient-accent-to-secondary: linear-gradient(90deg, rgba(255, 109, 106, .7) 0, rgba(0, 215, 231, .7) 100%);--ads-color-image-gradient-mask: linear-gradient(to bottom, rgba(0,0,0,0) 48%, rgba(0,0,0,.5) 80%, rgba(0,0,0,1) 100%);--ads-color-image-gradient-darken-bottom: linear-gradient(rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, .1) 40%, rgba(0, 0, 0, .4) 100%);--ads-color-app-gradient-secondary-to-accent: linear-gradient(160deg, rgba(255, 109, 106, .05) 0%, rgba(255, 109, 106, 0) 55%, rgba(255, 109, 106, .4) 90%), linear-gradient(220deg, rgba(0, 215, 231, .05) 0%, rgba(0, 215, 231, 0) 60%, rgba(0, 215, 231, .6) 90%), linear-gradient(var(--ads-color-primary), var(--ads-color-primary));--ads-color-app-gradient-secondary-to-accent-large: linear-gradient(170deg, rgba(255, 109, 106, .05) 0%, rgba(255, 109, 106, 0) 65%, rgba(255, 109, 106, .5) 90%), linear-gradient(210deg, rgba(0, 215, 231, .05) 0%, rgba(0, 215, 231, 0) 70%, rgba(0, 215, 231, .6) 90%), linear-gradient(var(--ads-color-primary), var(--ads-color-primary));--ads-color-app-gradient-secondary-to-accent-foreground: #fff;--ads-color-app-gradient-primary-to-accent: linear-gradient(200deg, rgba(255, 109, 106, .05) 0%, rgba(255, 109, 106, 0) 55%, rgba(255, 109, 106, .7) 90%), linear-gradient(160deg, rgba(30, 35, 110, .05) 0%, rgba(30, 35, 110, 0) 60%, rgba(30, 35, 110, .4) 90%), linear-gradient(var(--ads-color-secondary), var(--ads-color-secondary-40));--ads-color-app-gradient-primary-to-accent-large: linear-gradient(190deg, rgba(255, 109, 106, .05) 0%, rgba(255, 109, 106, 0) 65%, rgba(255, 109, 106, .6) 90%), linear-gradient(160deg, rgba(30, 35, 110, .05) 0%, rgba(30, 35, 110, 0) 70%, rgba(30, 35, 110, .5) 90%), linear-gradient(var(--ads-color-secondary), var(--ads-color-secondary-40));--ads-color-app-gradient-primary-to-accent-foreground: #1e236e;--ads-color-app-gradient-primary-inverted: linear-gradient(200deg, rgba(255, 109, 106, 0) 0%, rgba(255, 109, 106, 0) 60%, rgba(255, 109, 106, .4) 90%), linear-gradient(160deg, rgba(0, 215, 231, 0) 0%, rgba(0, 215, 231, 0) 65%, rgba(0, 215, 231, .45) 90%), linear-gradient(var(--ads-color-white), var(--ads-color-white));--ads-color-app-gradient-primary-inverted-large: linear-gradient(200deg, rgba(255, 109, 106, 0) 0%, rgba(255, 109, 106, 0) 75%, rgba(255, 109, 106, .05) 90%), linear-gradient(160deg, rgba(0, 215, 231, 0) 0%, rgba(0, 215, 231, 0) 75%, rgba(0, 215, 231, .02) 90%), linear-gradient(var(--ads-color-white), var(--ads-color-white));--ads-color-app-gradient-primary-inverted-foreground: #1e236e;--ads-ring_active: 0 0 0 2px #fff, 0 0 0 5px #1e236e;--ads-ring_focus: 0 0 0 2px #fff, 0 0 0 4px #1e236e;--ads-ring_hover: 0 0 0 2px #fff, 0 0 0 4px #1e236e;--ads-ring_transparent: 0 0 0 2px transparent, 0 0 0 3px transparent;--ads-ring_focus-inset: inset 0 0 0 2px #fff, inset 0 0 0 3px #1e236e;--ads-ring_focus-inset-inverted: inset 0 0 0 2px #1e236e, inset 0 0 0 4px #fff;--ads-ring-focus-with-contextmenu: 0 0 0 1px #fff, 0 0 0 2px #555cd1, 0 .7px .7px rgba(0, 0, 0, .05), 0 1.7px 1.7px rgba(0, 0, 0, .036), 0 3.1px 3.1px rgba(0, 0, 0, .03), 0 5.6px 5.6px rgba(0, 0, 0, .025), 0 10.4px 10.4px rgba(0, 0, 0, .02), 0 25px 25px rgba(0, 0, 0, .014);--ads-shadow-depth-0: 0 0 0 0 rgba(0, 0, 0, 0);--ads-shadow-depth-1: 0 .4px .4px rgba(0, 0, 0, .05), 0 1px 1px rgba(0, 0, 0, .036), 0 1.9px 1.9px rgba(0, 0, 0, .03), 0 3.4px 3.4px rgba(0, 0, 0, .025), 0 6.3px 6.3px rgba(0, 0, 0, .02), 0 15px 15px rgba(0, 0, 0, .014);--ads-shadow-depth-2: 0 .7px .7px rgba(0, 0, 0, .05), 0 1.7px 1.7px rgba(0, 0, 0, .036), 0 3.1px 3.1px rgba(0, 0, 0, .03), 0 5.6px 5.6px rgba(0, 0, 0, .025), 0 10.4px 10.4px rgba(0, 0, 0, .02), 0 25px 25px rgba(0, 0, 0, .014);--ads-shadow-depth-3: 0 .7px .7px rgba(0, 0, 0, .017), 0 1.7px 1.7px rgba(0, 0, 0, .024), 0 3.1px 3.1px rgba(0, 0, 0, .03), 0 5.6px 5.6px rgba(0, 0, 0, .036), 0 10.4px 10.4px rgba(0, 0, 0, .043), 0 25px 25px rgba(0, 0, 0, .06);--ads-shadow-depth-4: 0 1px 1px rgba(0, 0, 0, .014), 0 2.3px 2.3px rgba(0, 0, 0, .02), 0 4.4px 4.4px rgba(0, 0, 0, .025), 0 7.8px 7.8px rgba(0, 0, 0, .03), 0 14.6px 14.6px rgba(0, 0, 0, .036), 0 35px 35px rgba(0, 0, 0, .05);--ads-shadow-depth-5: 0 1.2px 1.2px rgba(0, 0, 0, .014), 0 3px 3px rgba(0, 0, 0, .02), 0 5.6px 5.6px rgba(0, 0, 0, .025), 0 10.1px 10.1px rgba(0, 0, 0, .03), 0 18.8px 18.8px rgba(0, 0, 0, .036), 0 45px 45px rgba(0, 0, 0, .05);--ads-shadow-depth-6: 0 .9px .9px rgba(0, 0, 0, .011), 0 1.9px 1.9px rgba(0, 0, 0, .016), 0 3.2px 3.2px rgba(0, 0, 0, .019), 0 4.8px 4.8px rgba(0, 0, 0, .022), 0 6.9px 6.9px rgba(0, 0, 0, .025), 0 9.7px 9.7px rgba(0, 0, 0, .028), 0 13.8px 13.8px rgba(0, 0, 0, .031), 0 20.1px 20.1px rgba(0, 0, 0, .034), 0 30.9px 30.9px rgba(0, 0, 0, .039), 0 55px 55px rgba(0, 0, 0, .05)}.ads-context-menu{position:relative;z-index:auto;display:inline-block;padding:0}.ads-context-menu ::ng-deep button.ads-custom-button{position:relative;display:inline-block;width:auto;align-items:center;padding:0;border:none;margin:0;-webkit-appearance:none;appearance:none;background-color:transparent;border-radius:.25rem;cursor:pointer;font-family:Alphabet sans pro,sans-serif;font-size:1rem;font-style:normal;font-weight:400;line-height:1;outline:0;outline-offset:0;transition:color .15s cubic-bezier(.55,.085,.68,.53),background-color .15s cubic-bezier(.55,.085,.68,.53);white-space:nowrap}.ads-context-menu ::ng-deep button.ads-custom-button:focus:not(:disabled){box-shadow:var(--ads-ring_focus)}.ads-context-menu ::ng-deep ul{position:absolute;top:3rem;right:auto;bottom:auto;left:0;display:none;width:16rem;max-width:calc(100vw - 4rem);max-height:25rem;padding:.5rem 0;border:1px solid var(--ads-color-gray-20);background-color:var(--ads-color-app);border-radius:.25rem;box-shadow:var(--ads-shadow-depth-3);list-style:none;overflow-x:hidden;overflow-y:auto}.ads-context-menu ::ng-deep ul li.context-menu_header{display:flex;align-items:center;padding:.5rem 1rem;color:var(--ads-color-primary);font-family:Alphabet sans pro,sans-serif;font-size:1rem;font-style:normal;font-weight:600}.ads-context-menu ::ng-deep ul li.context-menu_header span{flex:1 1 0%}.ads-context-menu ::ng-deep ul li.context-menu_header al-form-checkbox{flex:none}.ads-context-menu ::ng-deep ul li.context-menu_header al-form-checkbox .ads-form-checkbox.is-checkbox+label{margin-right:0;margin-bottom:0}.ads-context-menu ::ng-deep ul li.context-menu_header-title{display:flex;flex-direction:column;align-items:flex-start;padding:.5rem 1rem}.ads-context-menu ::ng-deep ul li.context-menu_header-title span{flex:1 1 0%}.ads-context-menu ::ng-deep ul li ads-button:not(.regular) .ads-button{width:100%;padding:1rem .625rem;border-radius:0;text-align:left}.ads-context-menu ::ng-deep ul li ads-button:not(.regular) .ads-button span{display:inline-block;max-width:80%;text-overflow:ellipsis;white-space:nowrap}.ads-context-menu ::ng-deep ul li ads-button:not(.regular) .ads-button.is-button-ghost:hover{background-color:var(--ads-color-gray-20);box-shadow:var(--ads-ring_transparent);color:var(--ads-color-gray-20_foreground)}.ads-context-menu ::ng-deep ul li ads-button:not(.regular) .ads-button.is-button-ghost:focus{background-color:var(--ads-color-secondary);box-shadow:var(--ads-ring_transparent);color:var(--ads-color-white)}.ads-context-menu ::ng-deep ul li ads-button:not(.regular) .ads-button.is-button-ghost:focus ::ng-deep .ads-icon svg path{fill:var(--ads-color-white)}.ads-context-menu ::ng-deep ul li al-form-checkbox{display:block}.ads-context-menu ::ng-deep ul li al-form-checkbox .ads-form-checkbox.is-switch+label{margin-bottom:0;font-size:.875rem}.ads-context-menu ::ng-deep ul li hr{border:none;border-top:1px solid var(--ads-color-gray-20);margin:0}.ads-context-menu.is-expanded ::ng-deep .ads-button[aria-haspopup=true]{box-shadow:var(--ads-ring_focus-with-contextmenu)}.ads-context-menu.is-expanded ::ng-deep ul{z-index:10;display:block}.ads-context-menu.place-floating-element-left ::ng-deep ul{right:0;left:auto}.ads-context-menu.place-floating-element-right ::ng-deep ul{right:auto;left:0}.ads-context-menu.place-floating-element-at-top ::ng-deep ul{top:auto;bottom:3rem}.ads-context-menu.place-floating-element-at-top.size-small ::ng-deep ul{top:auto;bottom:2.5rem}.ads-context-menu.place-floating-element-at-bottom ::ng-deep ul{top:3rem;bottom:auto}.ads-context-menu.place-floating-element-at-bottom.size-small ::ng-deep ul{top:2.5rem;bottom:auto}\n"] }]
        }], ctorParameters: function () { return [{ type: Window, decorators: [{
                    type: Inject,
                    args: [WINDOW]
                }] }, { type: Document, decorators: [{
                    type: Inject,
                    args: [DOCUMENT]
                }] }, { type: i0.ChangeDetectorRef }, { type: i1.CollisionDetectionService }]; }, propDecorators: { contextMenu: [{
                type: ViewChild,
                args: ['contextMenu']
            }], css: [{
                type: Input
            }], size: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGV4dC1tZW51LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2xpYnMvYWxwaGFiZXQtZGVzaWduLXN5c3RlbS11aS9zcmMvbGliL2NvbXBvbmVudHMvY29udGV4dC1tZW51L2NvbnRleHQtbWVudS5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL2FscGhhYmV0LWRlc2lnbi1zeXN0ZW0tdWkvc3JjL2xpYi9jb21wb25lbnRzL2NvbnRleHQtbWVudS9jb250ZXh0LW1lbnUuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLDhDQUE4QztBQUM5QyxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDM0MsT0FBTyxFQUVILHVCQUF1QixFQUN2QixpQkFBaUIsRUFDakIsU0FBUyxFQUNULFVBQVUsRUFDVixNQUFNLEVBQ04sS0FBSyxFQUNMLFNBQVMsR0FDWixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDN0MsT0FBTyxFQUFFLFlBQVksRUFBRSxjQUFjLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUNyRSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ2pDLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUV4QyxPQUFPLEVBQUUseUJBQXlCLEVBQUUsUUFBUSxFQUFFLE1BQU0sYUFBYSxDQUFDOzs7O0FBUzNELElBQU0sdUJBQXVCLEdBQTdCLE1BQU0sdUJBQXVCO0lBYWhDLFlBQ3FDLFNBQWlCLEVBQ2YsUUFBa0IsRUFDcEMsR0FBc0IsRUFDdEIsa0JBQTZDO1FBSDdCLGNBQVMsR0FBVCxTQUFTLENBQVE7UUFDZixhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQ3BDLFFBQUcsR0FBSCxHQUFHLENBQW1CO1FBQ3RCLHVCQUFrQixHQUFsQixrQkFBa0IsQ0FBMkI7UUFkekQsU0FBSSxHQUF3QixTQUFTLENBQUM7UUFFdEMsT0FBRSxHQUFHLG9CQUFvQixRQUFRLEVBQUUsRUFBRSxDQUFDO1FBSXZDLHFCQUFnQixHQUFHLENBQUMsQ0FBQztRQUU3QixZQUFPLEdBQUcsS0FBSyxDQUFDO0lBT2IsQ0FBQztJQUVJLE1BQU07UUFDVixJQUFJLENBQUMsT0FBTyxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQztRQUM3QixJQUFJLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQyxlQUFlLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO1FBQzFFLElBQUksQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFFLENBQUM7UUFFekIsSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ2QsSUFBSSxDQUFDLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLGFBQWEsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7U0FDcEY7SUFDTCxDQUFDO0lBRU8sS0FBSztRQUNULElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxDQUFDLENBQUM7UUFDMUIsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQzFCLENBQUM7SUFFTyxJQUFJO1FBQ1IsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO1FBQ3pELElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUMxQixDQUFDO0lBRU8sSUFBSTtRQUNSLElBQUksQ0FBQyxnQkFBZ0I7WUFDakIsSUFBSSxDQUFDLGdCQUFnQixHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxHQUFHLENBQUM7Z0JBQ3hELENBQUMsQ0FBQyxDQUFDO2dCQUNILENBQUMsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsQ0FBQyxDQUFDO1FBQ3BDLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUMxQixDQUFDO0lBRU8sUUFBUTtRQUNaLElBQUksQ0FBQyxnQkFBZ0I7WUFDakIsSUFBSSxDQUFDLGdCQUFnQixHQUFHLENBQUMsR0FBRyxDQUFDO2dCQUN6QixDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sR0FBRyxDQUFDO2dCQUNsQyxDQUFDLENBQUMsSUFBSSxDQUFDLGdCQUFnQixHQUFHLENBQUMsQ0FBQztRQUNwQyxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7SUFDMUIsQ0FBQztJQUVPLGNBQWM7UUFDbEIsTUFBTSxNQUFNLEdBQ1IsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUM5RSxNQUFNLFFBQVEsR0FDVixJQUFJLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUMsYUFBYSxDQUFDLG9CQUFvQixDQUFDLENBQUM7UUFDckYsTUFBTSxFQUFFLEtBQUssRUFBRSxDQUFDO1FBQ2hCLFFBQVEsRUFBRSxLQUFLLEVBQUUsQ0FBQztJQUN0QixDQUFDO0lBRUQsZUFBZTtRQUNYLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1FBQ2pGLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3RFLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQzlFLENBQUMsSUFBbUIsRUFBRSxFQUFFLENBQ3BCLElBQUksQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLElBQUksSUFBSSxDQUFDLGFBQWEsQ0FBQyxvQkFBb0IsQ0FBQyxDQUNwRixDQUFDO1FBRUYsSUFBSSxJQUFJLENBQUMsYUFBYSxFQUFFO1lBQ3BCLElBQUksQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDLGVBQWUsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDMUQsSUFBSSxDQUFDLGFBQWEsQ0FBQyxZQUFZLENBQUMsZUFBZSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1lBQzFELElBQUksQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDLGVBQWUsRUFBRSxNQUFNLENBQUMsQ0FBQztZQUV6RCxJQUFJLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQzdDLElBQUksQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQztZQUM5QyxJQUFJLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFFaEQsU0FBUyxDQUFhLElBQUksQ0FBQyxhQUFhLEVBQUUsT0FBTyxDQUFDO2lCQUM3QyxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO2lCQUMxQixTQUFTLENBQUMsR0FBRyxFQUFFO2dCQUNaLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztnQkFDZCxJQUFJLElBQUksQ0FBQyxPQUFPLEVBQUU7b0JBQ2QsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO2lCQUNoQjtxQkFBTTtvQkFDSCxJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssRUFBRSxDQUFDO2lCQUM5QjtZQUNMLENBQUMsQ0FBQyxDQUFDO1lBRVAsU0FBUyxDQUFnQixJQUFJLENBQUMsYUFBYSxFQUFFLFNBQVMsQ0FBQztpQkFDbEQsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztpQkFDMUIsU0FBUyxDQUFDLENBQUMsS0FBb0IsRUFBRSxFQUFFO2dCQUNoQyxJQUNJLEtBQUssQ0FBQyxHQUFHLCtDQUE4QjtvQkFDdkMsS0FBSyxDQUFDLEdBQUcsa0RBQWdDO29CQUN6QyxLQUFLLENBQUMsR0FBRyx5Q0FBMkIsRUFDdEM7b0JBQ0UsS0FBSyxDQUFDLGNBQWMsRUFBRSxDQUFDO29CQUN2QixJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7b0JBQ2QsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO2lCQUNoQjtnQkFDRCxJQUFJLEtBQUssQ0FBQyxHQUFHLDhDQUE4QixFQUFFO29CQUN6QyxLQUFLLENBQUMsY0FBYyxFQUFFLENBQUM7b0JBQ3ZCLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztvQkFDZCxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7aUJBQ2Y7Z0JBQ0QsSUFBSSxLQUFLLENBQUMsR0FBRywyQ0FBNEIsRUFBRTtvQkFDdkMsSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFO3dCQUNkLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQzt3QkFDZCxJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssRUFBRSxDQUFDO3FCQUM5QjtpQkFDSjtZQUNMLENBQUMsQ0FBQyxDQUFDO1lBRVAsU0FBUyxDQUFnQixJQUFJLENBQUMsV0FBVyxFQUFFLFNBQVMsQ0FBQztpQkFDaEQsSUFBSSxDQUNELGNBQWMsQ0FBQyxJQUFJLENBQUMsRUFDcEIsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FDN0I7aUJBQ0EsU0FBUyxDQUFDLENBQUMsS0FBb0IsRUFBRSxFQUFFO2dCQUNoQyxJQUFJLEtBQUssQ0FBQyxHQUFHLHFDQUF5QixFQUFFO29CQUNwQyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7aUJBQ2pCO2dCQUNELElBQUksS0FBSyxDQUFDLEdBQUcsa0RBQWdDLEVBQUU7b0JBQzNDLEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQztvQkFDdkIsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO2lCQUNmO2dCQUNELElBQUksS0FBSyxDQUFDLEdBQUcsOENBQThCLEVBQUU7b0JBQ3pDLEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQztvQkFDdkIsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO2lCQUNuQjtnQkFDRCxJQUFJLEtBQUssQ0FBQyxHQUFHLHVDQUEwQixFQUFFO29CQUNyQyxLQUFLLENBQUMsY0FBYyxFQUFFLENBQUM7b0JBQ3ZCLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztpQkFDaEI7Z0JBQ0QsSUFBSSxLQUFLLENBQUMsR0FBRyxxQ0FBeUIsRUFBRTtvQkFDcEMsS0FBSyxDQUFDLGNBQWMsRUFBRSxDQUFDO29CQUN2QixJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7aUJBQ2Y7Z0JBQ0QsSUFBSSxLQUFLLENBQUMsR0FBRywyQ0FBNEIsRUFBRTtvQkFDdkMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO29CQUNkLElBQUksQ0FBQyxhQUFhLEVBQUUsS0FBSyxFQUFFLENBQUM7aUJBQy9CO1lBQ0wsQ0FBQyxDQUFDLENBQUM7WUFFUCxTQUFTLENBQWEsSUFBSSxDQUFDLFdBQVcsRUFBRSxPQUFPLENBQUM7aUJBQzNDLElBQUksQ0FDRCxjQUFjLENBQUMsSUFBSSxDQUFDLEVBQ3BCLE1BQU0sQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQzdCO2lCQUNBLFNBQVMsQ0FBQyxDQUFDLEtBQWlCLEVBQUUsRUFBRTtnQkFDN0IsTUFBTSxNQUFNLEdBQUcsS0FBSyxDQUFDLE1BQWlCLENBQUM7Z0JBQ3ZDLE1BQU0sRUFBRSxHQUF5QixNQUFNLEVBQUUsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUN2RCw2QkFBNkI7Z0JBQzdCLElBQUksRUFBRSxFQUFFLFVBQVUsRUFBRSxRQUFRLEtBQUssWUFBWSxFQUFFO29CQUMzQyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7b0JBQ2QsSUFBSSxDQUFDLGFBQWEsQ0FBQyxLQUFLLEVBQUUsQ0FBQztpQkFDOUI7WUFDTCxDQUFDLENBQUMsQ0FBQztZQUVQLFNBQVMsQ0FBYSxJQUFJLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQztpQkFDeEMsSUFBSSxDQUNELGNBQWMsQ0FBQyxJQUFJLENBQUMsRUFDcEIsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FDN0I7aUJBQ0EsU0FBUyxDQUFDLENBQUMsS0FBaUIsRUFBRSxFQUFFO2dCQUM3QixNQUFNLE1BQU0sR0FBRyxLQUFLLENBQUMsTUFBaUIsQ0FBQztnQkFDdkMsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO2dCQUNuRCxJQUFJLENBQUMsTUFBTSxJQUFJLE1BQU0sQ0FBQyxFQUFFLEtBQUssSUFBSSxDQUFDLEVBQUUsRUFBRTtvQkFDbEMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO2lCQUNqQjtZQUNMLENBQUMsQ0FBQyxDQUFDO1lBRVAsU0FBUyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsUUFBUSxDQUFDO2lCQUM5QixJQUFJLENBQ0QsY0FBYyxDQUFDLElBQUksQ0FBQyxFQUNwQixNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUM3QjtpQkFDQSxTQUFTLENBQUMsR0FBRyxFQUFFLENBQ1osSUFBSSxDQUFDLGtCQUFrQixDQUFDLE1BQU0sQ0FDMUIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxhQUFhLEVBQzlCLElBQUksQ0FBQyxXQUFXLENBQ25CLENBQ0osQ0FBQztTQUNUO0lBQ0wsQ0FBQzs7b0hBN0xRLHVCQUF1QixrQkFjcEIsTUFBTSxhQUNOLFFBQVE7d0dBZlgsdUJBQXVCLDBNQzFCcEMsME9BU0E7QURpQmEsdUJBQXVCO0lBUG5DLFlBQVksRUFBRTtxQ0FxQnFDLE1BQU07UUFDTCxRQUFRO1FBQy9CLGlCQUFpQjtRQUNGLHlCQUF5QjtHQWpCekQsdUJBQXVCLENBOExuQztTQTlMWSx1QkFBdUI7MkZBQXZCLHVCQUF1QjtrQkFObkMsU0FBUzsrQkFDSSxrQkFBa0IsbUJBR1gsdUJBQXVCLENBQUMsTUFBTTs7MEJBZ0IxQyxNQUFNOzJCQUFDLE1BQU07OzBCQUNiLE1BQU07MkJBQUMsUUFBUTtvSEFkTSxXQUFXO3NCQUFwQyxTQUFTO3VCQUFDLGFBQWE7Z0JBQ2YsR0FBRztzQkFBWCxLQUFLO2dCQUNHLElBQUk7c0JBQVosS0FBSyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIGZ1bmN0aW9uYWwvaW1tdXRhYmxlLWRhdGEgKi9cclxuaW1wb3J0IHsgRE9DVU1FTlQgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xyXG5pbXBvcnQge1xyXG4gICAgQWZ0ZXJWaWV3SW5pdCxcclxuICAgIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxyXG4gICAgQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICBDb21wb25lbnQsXHJcbiAgICBFbGVtZW50UmVmLFxyXG4gICAgSW5qZWN0LFxyXG4gICAgSW5wdXQsXHJcbiAgICBWaWV3Q2hpbGQsXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFdJTkRPVyB9IGZyb20gJ0BuZy13ZWItYXBpcy9jb21tb24nO1xyXG5pbXBvcnQgeyBVbnRpbERlc3Ryb3ksIHVudGlsRGVzdHJveWVkIH0gZnJvbSAnQG5nbmVhdC91bnRpbC1kZXN0cm95JztcclxuaW1wb3J0IHsgZnJvbUV2ZW50IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IGZpbHRlciB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgQURTS2V5RXZlbnRzIH0gZnJvbSAnLi4vLi4vdHlwZXMnO1xyXG5pbXBvcnQgeyBDb2xsaXNpb25EZXRlY3Rpb25TZXJ2aWNlLCByYW5kb21JZCB9IGZyb20gJy4uLy4uL3V0aWxzJztcclxuXHJcbkBVbnRpbERlc3Ryb3koKVxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnYWRzLWNvbnRleHQtbWVudScsXHJcbiAgICB0ZW1wbGF0ZVVybDogJy4vY29udGV4dC1tZW51LmNvbXBvbmVudC5odG1sJyxcclxuICAgIHN0eWxlVXJsczogWycuL2NvbnRleHQtbWVudS5jb21wb25lbnQuc2NzcyddLFxyXG4gICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBBRFNDb250ZXh0TWVudUNvbXBvbmVudCBpbXBsZW1lbnRzIEFmdGVyVmlld0luaXQge1xyXG4gICAgQFZpZXdDaGlsZCgnY29udGV4dE1lbnUnKSBjb250ZXh0TWVudSE6IEVsZW1lbnRSZWY7XHJcbiAgICBASW5wdXQoKSBjc3MhOiBzdHJpbmc7XHJcbiAgICBASW5wdXQoKSBzaXplOiAnc21hbGwnIHwgJ3JlZ3VsYXInID0gJ3JlZ3VsYXInO1xyXG5cclxuICAgIHJlYWRvbmx5IGlkID0gYGFkcy1jb250ZXh0LW1lbnUtJHtyYW5kb21JZCgpfWA7XHJcbiAgICBwcml2YXRlIGJ1dHRvbkVsZW1lbnQhOiBIVE1MQnV0dG9uRWxlbWVudDtcclxuICAgIHByaXZhdGUgbWVudUVsZW1lbnQhOiBIVE1MVUxpc3RFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBtZW51RWxlbWVudEl0ZW1zITogQXJyYXk8SFRNTExJRWxlbWVudD47XHJcbiAgICBwcml2YXRlIHNlbGVjdGVkTWVudUl0ZW0gPSAwO1xyXG5cclxuICAgIHZpc2libGUgPSBmYWxzZTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBASW5qZWN0KFdJTkRPVykgcHJpdmF0ZSByZWFkb25seSB3aW5kb3dSZWY6IFdpbmRvdyxcclxuICAgICAgICBASW5qZWN0KERPQ1VNRU5UKSBwcml2YXRlIHJlYWRvbmx5IGRvY3VtZW50OiBEb2N1bWVudCxcclxuICAgICAgICBwcml2YXRlIHJlYWRvbmx5IGNkcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICAgICAgcHJpdmF0ZSByZWFkb25seSBjb2xsaXNpb25EZXRlY3Rpb246IENvbGxpc2lvbkRldGVjdGlvblNlcnZpY2UsXHJcbiAgICApIHt9XHJcblxyXG4gICAgcHJpdmF0ZSB0b2dnbGUoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy52aXNpYmxlID0gIXRoaXMudmlzaWJsZTtcclxuICAgICAgICB0aGlzLmJ1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgdGhpcy52aXNpYmxlLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIHRoaXMuY2RyLmRldGVjdENoYW5nZXMoKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMudmlzaWJsZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbGxpc2lvbkRldGVjdGlvbi5kZXRlY3QodGhpcy5jb250ZXh0TWVudS5uYXRpdmVFbGVtZW50LCB0aGlzLm1lbnVFbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBmaXJzdCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkTWVudUl0ZW0gPSAwO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0TWVudUl0ZW0oKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGxhc3QoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZE1lbnVJdGVtID0gdGhpcy5tZW51RWxlbWVudEl0ZW1zLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RNZW51SXRlbSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbmV4dCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkTWVudUl0ZW0gPVxyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkTWVudUl0ZW0gKyAxID4gdGhpcy5tZW51RWxlbWVudEl0ZW1zLmxlbmd0aCAtIDFcclxuICAgICAgICAgICAgICAgID8gMFxyXG4gICAgICAgICAgICAgICAgOiB0aGlzLnNlbGVjdGVkTWVudUl0ZW0gKyAxO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0TWVudUl0ZW0oKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHByZXZpb3VzKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRNZW51SXRlbSA9XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRNZW51SXRlbSAtIDEgPCAwXHJcbiAgICAgICAgICAgICAgICA/IHRoaXMubWVudUVsZW1lbnRJdGVtcy5sZW5ndGggLSAxXHJcbiAgICAgICAgICAgICAgICA6IHRoaXMuc2VsZWN0ZWRNZW51SXRlbSAtIDE7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RNZW51SXRlbSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2VsZWN0TWVudUl0ZW0oKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgYnV0dG9uOiBIVE1MQnV0dG9uRWxlbWVudCB8IG51bGwgPVxyXG4gICAgICAgICAgICB0aGlzLm1lbnVFbGVtZW50SXRlbXNbdGhpcy5zZWxlY3RlZE1lbnVJdGVtXS5xdWVyeVNlbGVjdG9yKCcuYWRzLWJ1dHRvbicpO1xyXG4gICAgICAgIGNvbnN0IGNoZWNrYm94OiBIVE1MSW5wdXRFbGVtZW50IHwgbnVsbCA9XHJcbiAgICAgICAgICAgIHRoaXMubWVudUVsZW1lbnRJdGVtc1t0aGlzLnNlbGVjdGVkTWVudUl0ZW1dLnF1ZXJ5U2VsZWN0b3IoJy5hZHMtZm9ybS1jaGVja2JveCcpO1xyXG4gICAgICAgIGJ1dHRvbj8uZm9jdXMoKTtcclxuICAgICAgICBjaGVja2JveD8uZm9jdXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XHJcbiAgICAgICAgdGhpcy5idXR0b25FbGVtZW50ID0gdGhpcy5jb250ZXh0TWVudS5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZHMtYnV0dG9uJyk7XHJcbiAgICAgICAgdGhpcy5tZW51RWxlbWVudCA9IHRoaXMuY29udGV4dE1lbnUubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpO1xyXG4gICAgICAgIHRoaXMubWVudUVsZW1lbnRJdGVtcyA9IEFycmF5LmZyb20odGhpcy5tZW51RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdsaScpKS5maWx0ZXIoXHJcbiAgICAgICAgICAgIChpdGVtOiBIVE1MTElFbGVtZW50KSA9PlxyXG4gICAgICAgICAgICAgICAgaXRlbS5xdWVyeVNlbGVjdG9yKCcuYWRzLWJ1dHRvbicpID8/IGl0ZW0ucXVlcnlTZWxlY3RvcignLmFkcy1mb3JtLWNoZWNrYm94JyksXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuYnV0dG9uRWxlbWVudCkge1xyXG4gICAgICAgICAgICB0aGlzLmJ1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJywgdGhpcy5pZCk7XHJcbiAgICAgICAgICAgIHRoaXMuYnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcclxuICAgICAgICAgICAgdGhpcy5idXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1oYXNwb3B1cCcsICd0cnVlJyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm1lbnVFbGVtZW50LnNldEF0dHJpYnV0ZSgnaWQnLCB0aGlzLmlkKTtcclxuICAgICAgICAgICAgdGhpcy5tZW51RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnbGlzdCcpO1xyXG4gICAgICAgICAgICB0aGlzLm1lbnVFbGVtZW50LnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnLTEnKTtcclxuXHJcbiAgICAgICAgICAgIGZyb21FdmVudDxNb3VzZUV2ZW50Pih0aGlzLmJ1dHRvbkVsZW1lbnQsICdjbGljaycpXHJcbiAgICAgICAgICAgICAgICAucGlwZSh1bnRpbERlc3Ryb3llZCh0aGlzKSlcclxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcnN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idXR0b25FbGVtZW50LmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBmcm9tRXZlbnQ8S2V5Ym9hcmRFdmVudD4odGhpcy5idXR0b25FbGVtZW50LCAna2V5ZG93bicpXHJcbiAgICAgICAgICAgICAgICAucGlwZSh1bnRpbERlc3Ryb3llZCh0aGlzKSlcclxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoKGV2ZW50OiBLZXlib2FyZEV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5rZXkgPT09IEFEU0tleUV2ZW50cy5LRVlfU1BBQ0VCQVIgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQua2V5ID09PSBBRFNLZXlFdmVudHMuS0VZX0FSUk9XX0RPV04gfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQua2V5ID09PSBBRFNLZXlFdmVudHMuS0VZX0VOVEVSXHJcbiAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyc3QoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gQURTS2V5RXZlbnRzLktFWV9BUlJPV19VUCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3QoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gQURTS2V5RXZlbnRzLktFWV9FU0NBUEUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnV0dG9uRWxlbWVudC5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBmcm9tRXZlbnQ8S2V5Ym9hcmRFdmVudD4odGhpcy5tZW51RWxlbWVudCwgJ2tleWRvd24nKVxyXG4gICAgICAgICAgICAgICAgLnBpcGUoXHJcbiAgICAgICAgICAgICAgICAgICAgdW50aWxEZXN0cm95ZWQodGhpcyksXHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyKCgpID0+IHRoaXMudmlzaWJsZSksXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAuc3Vic2NyaWJlKChldmVudDogS2V5Ym9hcmRFdmVudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09IEFEU0tleUV2ZW50cy5LRVlfVEFCKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09IEFEU0tleUV2ZW50cy5LRVlfQVJST1dfRE9XTikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5leHQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gQURTS2V5RXZlbnRzLktFWV9BUlJPV19VUCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZpb3VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09IEFEU0tleUV2ZW50cy5LRVlfSE9NRSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcnN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09IEFEU0tleUV2ZW50cy5LRVlfRU5EKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQua2V5ID09PSBBRFNLZXlFdmVudHMuS0VZX0VTQ0FQRSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ1dHRvbkVsZW1lbnQ/LmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBmcm9tRXZlbnQ8TW91c2VFdmVudD4odGhpcy5tZW51RWxlbWVudCwgJ2NsaWNrJylcclxuICAgICAgICAgICAgICAgIC5waXBlKFxyXG4gICAgICAgICAgICAgICAgICAgIHVudGlsRGVzdHJveWVkKHRoaXMpLFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlcigoKSA9PiB0aGlzLnZpc2libGUpLFxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgLnN1YnNjcmliZSgoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQgYXMgRWxlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaTogSFRNTExJRWxlbWVudCB8IG51bGwgPSB0YXJnZXQ/LmNsb3Nlc3QoJ2xpJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gb25seSBjbG9zZSBpZiBpdHMgYSBidXR0b25cclxuICAgICAgICAgICAgICAgICAgICBpZiAobGk/LmZpcnN0Q2hpbGQ/Lm5vZGVOYW1lID09PSAnQURTLUJVVFRPTicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idXR0b25FbGVtZW50LmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBmcm9tRXZlbnQ8TW91c2VFdmVudD4odGhpcy5kb2N1bWVudCwgJ2NsaWNrJylcclxuICAgICAgICAgICAgICAgIC5waXBlKFxyXG4gICAgICAgICAgICAgICAgICAgIHVudGlsRGVzdHJveWVkKHRoaXMpLFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlcigoKSA9PiB0aGlzLnZpc2libGUpLFxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgLnN1YnNjcmliZSgoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQgYXMgRWxlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnQgPSB0YXJnZXQuY2xvc2VzdCgnLmFkcy1jb250ZXh0LW1lbnUnKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmVudCB8fCBwYXJlbnQuaWQgIT09IHRoaXMuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGZyb21FdmVudCh0aGlzLndpbmRvd1JlZiwgJ3Jlc2l6ZScpXHJcbiAgICAgICAgICAgICAgICAucGlwZShcclxuICAgICAgICAgICAgICAgICAgICB1bnRpbERlc3Ryb3llZCh0aGlzKSxcclxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXIoKCkgPT4gdGhpcy52aXNpYmxlKSxcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoKCkgPT5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbGxpc2lvbkRldGVjdGlvbi5kZXRlY3QoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dE1lbnUubmF0aXZlRWxlbWVudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW51RWxlbWVudCxcclxuICAgICAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIiwiPCEtLSBDb250ZXh0IG1lbnUgLS0+XHJcbjxkaXZcclxuICAgICNjb250ZXh0TWVudVxyXG4gICAgaWQ9XCJ7eyBpZCB9fVwiXHJcbiAgICBjbGFzcz1cImFkcy1jb250ZXh0LW1lbnUgc2l6ZS17eyBzaXplIH19IHt7IGNzcyB9fVwiXHJcbiAgICBbbmdDbGFzc109XCJ7ICdpcy1leHBhbmRlZCc6IHZpc2libGUgfVwiXHJcbj5cclxuICAgIDxuZy1jb250ZW50PjwvbmctY29udGVudD5cclxuPC9kaXY+XHJcbiJdfQ==